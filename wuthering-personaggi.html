<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Wuthering Waves — Characters</title>
<link rel="stylesheet" href="assets/style.css?v=20250809">
<script defer src="assets/filters.js?v=20250809"></script>
</head>
<body>
<header class="site-header">
  <div></div>
  <a class="logo-wrap" href="index.html" title="Back to Home"><img class="site-logo" src="assets/logo.png" alt="Bolle Gacha Logo"></a>
  <div></div>
</header>

<main class="container">
  <h1>Wuthering Waves — Characters</h1>

  <!-- FILTRI -->
  <div class="filters">
    <div class="filter-box"><label>Search<br><input id="q" type="search" placeholder="Search name..."></label></div>
    <div class="filter-box"><label>Rarity<br>
      <select id="rarity">
        <option value="">All</option>
        <option value="5">5★</option>
        <option value="4">4★</option>
      </select></label></div>
    <div class="filter-box"><label>Weapon<br>
      <select id="weapon">
        <option value="">All</option>
        <option>Sword</option><option>Broadblade</option><option>Gauntlets</option>
        <option>Pistols</option><option>Rectifier</option>
      </select></label></div>
    <div class="filter-box"><label>Element<br>
      <select id="element">
        <option value="">All</option>
        <option>Aero</option><option>Electro</option><option>Fusion</option>
        <option>Glacio</option><option>Havoc</option><option>Spectro</option>
      </select></label></div>
  </div>

  <!-- GRIGLIA VUOTA: verrà popolata da JS -->
  <div class="characters-grid" id="grid"></div>
</main>

<script>
  document.addEventListener('DOMContentLoaded', ()=>{
    document.querySelectorAll('.characters-grid .char-card').forEach(el=>el.remove());

    fetch('assets/wuwa_roster.json?v=20250809')
      .then(r=>r.json())
      .then(list=>{
        const wrap = document.getElementById('grid');
        wrap.innerHTML = list.map(c => `
          <a class="char-card" href="${c.link}"
             data-name="${c.name||''}"
             data-rarity="${c.rarity||''}"
             data-weapon="${c.weapon||c.path||''}"
             data-element="${c.element||''}">
            <div class="char-top">
              <div class="char-name">${c.name||''}</div>
              <div class="meta">
                ${c.element?`<span class="badge">${c.element}</span>`:''}
                ${c.weapon?`<span class="badge">${c.weapon}</span>`:''}
                ${c.rarity?`<span class="badge">${c.rarity}★</span>`:''}
              </div>
            </div>
          </a>
        `).join('');
        if (window.filterCharacters) window.filterCharacters();
      })
      .catch(e=>{
        console.error(e);
        document.getElementById('grid').innerHTML = '<div class="panel">Errore caricamento roster WuWa.</div>';
      });
  });
</script>
<script>
  // --- WUWA ENRICHER: compila Weapon/Element mancanti ---
  const WUWA_WEAPON = {
    "Calcharo":"Broadblade","Jiyan":"Broadblade","Lingyang":"Gauntlets",
    "Encore":"Rectifier","Verina":"Rectifier","Yinlin":"Rectifier",
    "Sanhua":"Sword","Taoqi":"Broadblade","Jianxin":"Gauntlets",
    "Danjin":"Sword","Aalto":"Pistols","Yangyang":"Sword",
    "Mortefi":"Pistols","Yuanwu":"Gauntlets","Baizhi":"Rectifier",
    "Rover (Spectro)":"Sword","Rover (Havoc)":"Sword"
  };
  const WUWA_ELEM = {
    "Calcharo":"Electro","Jiyan":"Aero","Lingyang":"Glacio",
    "Encore":"Fusion","Verina":"Spectro","Yinlin":"Electro",
    "Sanhua":"Glacio","Taoqi":"Havoc","Jianxin":"Aero",
    "Danjin":"Fusion","Aalto":"Aero","Yangyang":"Aero",
    "Mortefi":"Fusion","Yuanwu":"Electro","Baizhi":"Glacio",
    "Rover (Spectro)":"Spectro","Rover (Havoc)":"Havoc"
  };
  function enrichWUWA(list){
    return list.map(c=>{
      const name=c.name||"";
      const filled = { ...c };
      if(!filled.weapon && WUWA_WEAPON[name]) filled.weapon = WUWA_WEAPON[name];
      if(!filled.element && WUWA_ELEM[name]) filled.element = WUWA_ELEM[name];
      return filled;
    });
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    const wrap = document.getElementById('grid');
    fetch('assets/wuwa_roster.json?v=20250809')
      .then(r=>r.json())
      .then(raw=>{
        const list = enrichWUWA(raw);
        wrap.innerHTML = list.map(c => `
          <a class="char-card" href="${c.link}"
             data-name="${c.name||''}"
             data-rarity="${c.rarity||''}"
             data-weapon="${c.weapon||''}"
             data-element="${c.element||''}">
            <div class="char-top">
              <div class="char-name">${c.name||''}</div>
              <div class="meta">
                ${c.element?`<span class="badge">${c.element}</span>`:''}
                ${c.weapon?`<span class="badge">${c.weapon}</span>`:''}
                ${c.rarity?`<span class="badge">${c.rarity}★</span>`:''}
              </div>
            </div>
          </a>
        `).join('');
        if (window.filterCharacters) window.filterCharacters();
      })
      .catch(e=>{ console.error(e); wrap.innerHTML='<div class="panel">Errore caricamento roster WuWa.</div>'; });
  });
</script>
</body>
</html>
